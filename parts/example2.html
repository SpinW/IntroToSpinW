<section>
    <section class="subsection color--radiant" id="Example2_0">
        <div class="grid-wrapper">
            <div class="logo"></div>
            <h1>Ferromagnetic first neighbor Kagome lattice</h1>
            <div class="description">
                Download the script here: <a href="matlab/sw_tutorial_02.m" style="color: white"><code>sw_tutorial_02.m</code></a>
            </div>
        </div>
    </section>

    <section class="blank color--dark" id="Example2_1">
    <div class="grid-wrapper">
        <div class="header">
            <div class="logo"></div>
            <div class="section">Creating the lattice</div>
        </div>
        <content>
            <h2>Creating the lattice</h2>
            <p>
                We define the kagome lattice using the "P -3" space group (Nr. 147),
                using the 3 fold symmetry, we need to define only one magnetic atom. In
                this space group all first neighbor couplings will be equivalent (related
                by symmetry). Symmetry equivalent positions of the magnetic atoms are
                automatically generated by the <code>spinw.matom</code> method. The magnetic atoms
                are Cu$^+$ with $S=1$ spin.

            </p>
            <figure class="code">
                    <pre><code class="matlab">FMkagome = spinw;
FMkagome.genlattice('lat_const',[6 6 5],'angled',[90 90 120],'spgr','P -3')
FMkagome.addatom('r', [1/2 0 0], 'S', 1, 'label','MCu1','color','r')</code></pre>
            </figure><br>
            <h3>Questions:</h3>
            <p><i>Display the magnetic atoms which have been generated using the <code>table</code> method. <br> Plot the lattice so that you can see the kagome structure.</i></p>
        </content>
    </div>
</section>

    <section class="blank color--dark" id="Example2_2">
        <div class="grid-wrapper">
            <div class="header">
                <div class="logo"></div>
                <div class="section">Adding the interactions</div>
            </div>
            <content>
                <h2>Adding the interactions</h2>
                <p>
                    The first neighbor bonds will be ferromagnetic, J1 = -1 meV. The
                    <code>spinw.gencoupling</code> will use the space group operators to identify
                    equivalent couplings, if two bonds have the same length but are not symmetry
                    related, then they will be identified as different bonds. The
                    '<code>maxDistance</code>' option of the <code>spinw.gencoupling</code> method will be ensure that
                    all bonds are generated up to the given distance in Angstrom.
                </p>
                <figure class="code">
                    <pre><code class="matlab">FMkagome.gencoupling('maxDistance',4)
disp('Bonds (length in Angstrom):')
FMkagome.table('bond',[])</code></pre>
                </figure><br>
                <h3>Questions:</h3>
                <p><i>Change the '<code>maxDistance</code>' value. Whats the second and third coupling?<br> Add a matrix labeled <code>J1</code> with value -1 and assign it to the nearest neighbour bond.</i></p>
            </content>
        </div>
    </section>

    <section class="blank color--dark" id="Example2_3">
        <div class="grid-wrapper">
            <div class="header">
                <div class="logo"></div>
                <div class="section">Adding the magnetic structure</div>
            </div>
            <content>
                <h2>Adding the magnetic structure</h2>
                <p>
                    All spins are parallel, pointing along the y-axis (perpendicular to ac
                    plane). We use the "helical" mode of the <code>sw.gencoupling()</code> function, even
                    though the structure is not helical. However in this mode all missing
                    spins will be automatically created using the k-vector and normal vector
                    and assuming helical magnetic structure. Thus if we give $\mathbf{k}$ = (0 0 0) and
                    only the direction of the first spin in the unit cell, the code will
                    create all other spin parallel to the first.

                </p>
                <figure class="code">
                    <pre><code class="matlab">FMkagome.genmagstr('mode', 'helical', 'k', [0 0 0], 'n', [0 1 0], 'S', [0 1 0]')
disp('Magnetic structure:')
FMkagome.table('mag')
FMkagome.energy
plot(FMkagome,'range',[2 2 1])</code></pre>
                </figure><br>
                <p>We will talk about the modes of <code>genmagstr</code> in another presentation.</p>
                </content>
        </div>
    </section>

    <section class="blank color--dark" id="Example2_4">
        <div class="grid-wrapper">
            <div class="header">
                <div class="logo"></div>
                <div class="section">Spin wave dispersion</div>
            </div>
            <content>
                <h2>Spin wave dispersion</h2>
                <p>
                    We calculate the spin wave dispersion. There are three modes, equal to
                    the number of magnetic atom in the magnetic unit cell, denoted by
                    different colors. At the zone center, the dispersion of the goldstone
                    mode is parabolic, due to the FM interactions.

                </p>
                <figure class="code">
                    <pre><code class="matlab">fmkSpec = FMkagome.spinwave({[-1/2 0 0] [0 0 0] [1/2 1/2 0] 100},'hermit',false);
fmkSpec = sw_neutron(fmkSpec);
fmkSpec = sw_egrid(fmkSpec, 'Evect',linspace(0,6.5,100),'component','Sperp');
figure
sw_plotspec(fmkSpec,'mode',1,'colorbar',false,'axLim',[0 8])</code></pre>
                </figure><br>
                <h3>Questions:</h3>
                <p><i>Read the help of <code>sw_plotspec</code>. Try different '<code>mode</code>' options for example.</i></p>
            </content>
        </div>
    </section>

    <section class="blank color--dark" id="Example2_5">
        <div class="grid-wrapper">
            <div class="header">
                <div class="logo"></div>
                <div class="section">Powder spectrum</div>
            </div>
            <content>
                <h2>Powder spectrum</h2>
                <p>
                    We can also calculate the powder spectrum by averaging over random orientations. We plot the powder spectrum two different ways. First as calculated (to
                    show the extremely sharp Van Hoove singularity at the top of the
                    dispersion), secondly convolute with a Gaussian along energy (Which is much more like what you see experimentally).
                </p>
                <figure class="code">
                    <pre><code class="matlab">fmkPow = FMkagome.powspec(linspace(0,2.5,100),'Evect',linspace(0,7,250),'nRand',1000,'hermit',false);
figure
subplot(2,1,1)
sw_plotspec(fmkPow,'colorbar',true,'axLim',[0 0.05])</code></pre>
                </figure><br>
                <h3>Questions:</h3>
                <p><i>Read the help of <code>sw_plotspec</code> and convolute in energy with a normalised gaussian of width 0.25meV.</i></p>
            </content>
        </div>
    </section>

    <section class="blank color--dark" id="Example2_6">
        <div class="grid-wrapper">
            <div class="header">
                <div class="logo"></div>
                <div class="section">Density of states</div>
            </div>
            <content>
                <h2>Density of states</h2>
                <p>
                    We can plot the density of magnon states by calculating the weight of
                    random points in the first Brillouin Zone. Then we can convolute with a
                    Gaussian for better plotting and sum up all the Q points.
                </p>
                <figure class="code">
                    <pre><code class="matlab">nQ = 1E5;
Q = rand(3, nQ);

spec = FMkagome.spinwave(Q, 'hermit', false);
spec = sw_egrid(spec, 'component', 'Sxx+Syy+Szz');
spec = sw_instrument(spec, 'dE', 0.1);
I = sum(spec.swConv, 2);
E = spec.Evect(2:end);</code></pre>
                </figure><br>
                <h3>Questions:</h3>
                <p><i>Why did we choose the '<code>Sxx+Syy+Szz</code>' component?</i></p>
            </content>
        </div>
    </section>

</section>
